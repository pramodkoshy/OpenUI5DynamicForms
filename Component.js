sap.ui.define(["sap/ui/core/UIComponent","sap/ui/Device","./model/models","./model/EntityCacheManager"],function(e,t,i,a){"use strict";window["sap-ui-config"]=window["sap-ui-config"]||{};window["sap-ui-config"].flexibilityServices=false;return e.extend("com.supabase.easyui5.Component",{metadata:{manifest:"json",interfaces:["sap.ui.core.IAsyncContentCreation"]},init:function(){e.prototype.init.apply(this,arguments);const t=new sap.ui.model.json.JSONModel(sap.ui.Device);t.setDefaultBindingMode("OneWay");this.setModel(t,"device");const i=new sap.ui.model.json.JSONModel({navExpanded:!sap.ui.Device.system.phone});this.setModel(i,"appView");this.initTheme();this.initSupabase();this.getRouter().initialize();this._entityCacheManager=new a;setTimeout(this._initSplitApp.bind(this),100)},getEntityCacheManager:function(){return this._entityCacheManager},getSupabaseClient:function(){return window.supabaseClient},initSupabase:function(){const e="https://lqoiklybmvslmkitllyp.supabase.co";const t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imxxb2lrbHlibXZzbG1raXRsbHlwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDE0NTI3MDMsImV4cCI6MjA1NzAyODcwM30.407lGtQeSNQ6RUarDOIpFnfh0E9sqz0SHXgd1ug3ffA";const i=document.createElement("script");i.type="module";i.onload=()=>{window.supabaseClient=window.supabase.createClient(e,t);const i=new sap.ui.model.json.JSONModel({tables:[{id:"suppliers",title:"Suppliers",icon:"sap-icon://supplier"},{id:"products",title:"Products",icon:"sap-icon://product"},{id:"customers",title:"Customers",icon:"sap-icon://customer"},{id:"orders",title:"Orders",icon:"sap-icon://sales-order"},{id:"order_items",title:"Order Items",icon:"sap-icon://list"}]});this.setModel(i,"tables");console.log("Tables model initialized with tables:",i.getProperty("/tables").length);this._initAppControllers()};i.src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2";document.head.appendChild(i)},initTheme:function(){const e=["sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"];let t=localStorage.getItem("preferredTheme");if(!t||!e.includes(t)){t="sap_horizon"}sap.ui.getCore().applyTheme(t);const i=new sap.ui.model.json.JSONModel({theme:t});this.setModel(i,"settings")},_initSplitApp:function(){try{const e=this.getSplitApp();if(!e){console.error("SplitApp not found");setTimeout(this._initSplitApp.bind(this),1e3);return}if(sap.ui.Device.system.phone){e.setMode("PopoverMode");const t=this.getModel("appView");if(t){t.setProperty("/navExpanded",false)}}else if(sap.ui.Device.system.tablet){e.setMode("ShowHideMode");if(window.innerHeight>window.innerWidth){e.hideMaster()}}else{e.setMode("ShowHideMode");e.showMaster()}}catch(e){console.error("Error initializing SplitApp:",e)}},getSplitApp:function(){try{const e=this.getRootControl();if(!e){console.warn("Root control not found");return null}const t=e.byId("app");if(t){console.log("SplitApp found by ID");return t}const i=function(e){if(e instanceof sap.m.SplitApp){return e}const t=e.getMetadata().getAllAggregations();for(let a in t){const t=e.getAggregation(a);if(!t){continue}const r=Array.isArray(t)?t:[t];for(let e=0;e<r.length;e++){const t=i(r[e]);if(t){return t}}}return null};const a=i(e);if(a){console.log("SplitApp found through control tree search");return a}console.warn("SplitApp not found in control tree");return null}catch(e){console.error("Error in getSplitApp:",e);return null}},getContentDensityClass:function(){if(!this._sContentDensityClass){if(document.body.classList.contains("sapUiSizeCozy")||document.body.classList.contains("sapUiSizeCompact")){this._sContentDensityClass=""}else if(!sap.ui.Device.support.touch){this._sContentDensityClass="sapUiSizeCompact"}else{this._sContentDensityClass="sapUiSizeCozy"}}return this._sContentDensityClass},getTableMetadata:function(e){const t=`metadata_${e}`;if(this._entityCacheManager){if(this._entityCacheManager.isCached(t)){return this._entityCacheManager.getEntityData(t,{},()=>Promise.resolve(this._getDefaultTableMetadata(e)))}}return Promise.resolve(this._getDefaultTableMetadata(e))},_getDefaultTableMetadata:function(e){this._tableMetadataCache=this._tableMetadataCache||{};if(this._tableMetadataCache[e]){return this._tableMetadataCache[e]}const t={suppliers:{primaryKey:"supplier_id",titleField:"company_name",subtitleField:"contact_name",columns:[{name:"supplier_id",label:"ID",type:"string",visible:true,editable:false,required:false},{name:"company_name",label:"Company",type:"string",visible:true,editable:true,required:true},{name:"contact_name",label:"Contact Name",type:"string",visible:true,editable:true,required:false},{name:"email",label:"Contact Email",type:"email",visible:true,editable:true,required:false},{name:"phone",label:"Phone",type:"string",visible:true,editable:true,required:false},{name:"address",label:"Address",type:"text",visible:true,editable:true,required:false},{name:"city",label:"City",type:"string",visible:true,editable:true,required:false},{name:"country",label:"Country",type:"string",visible:true,editable:true,required:false},{name:"created_at",label:"Created At",type:"date",visible:true,editable:false,required:false},{name:"updated_at",label:"Updated At",type:"date",visible:true,editable:false,required:false}],relations:[{table:"products",foreignKey:"supplier_id"}]},products:{primaryKey:"product_id",titleField:"product_name",subtitleField:"description",columns:[{name:"product_id",label:"ID",type:"string",visible:true,editable:false,required:false},{name:"product_name",label:"Name",type:"string",visible:true,editable:true,required:true},{name:"description",label:"Description",type:"text",visible:true,editable:true,required:false},{name:"unit_price",label:"Price",type:"number",visible:true,editable:true,required:true},{name:"category",label:"Category",type:"string",visible:true,editable:true,required:false},{name:"supplier_id",label:"Supplier",type:"relation",relation:"suppliers",visible:true,editable:true,required:true},{name:"created_at",label:"Created At",type:"date",visible:true,editable:false,required:false},{name:"updated_at",label:"Updated At",type:"date",visible:true,editable:false,required:false}],relations:[{table:"order_items",foreignKey:"product_id"}]},customers:{primaryKey:"customer_id",titleField:"name",subtitleField:"email",columns:[{name:"customer_id",label:"ID",type:"string",visible:true,editable:false,required:false},{name:"name",label:"Name",type:"string",visible:true,editable:true,required:true},{name:"email",label:"Email",type:"email",visible:true,editable:true,required:true},{name:"phone",label:"Phone",type:"string",visible:true,editable:true,required:false},{name:"address",label:"Address",type:"text",visible:true,editable:true,required:false},{name:"city",label:"City",type:"string",visible:true,editable:true,required:false},{name:"country",label:"Country",type:"string",visible:true,editable:true,required:false},{name:"created_at",label:"Created At",type:"date",visible:true,editable:false,required:false},{name:"updated_at",label:"Updated At",type:"date",visible:true,editable:false,required:false}],relations:[{table:"orders",foreignKey:"customer_id"}]},orders:{primaryKey:"order_id",titleField:"id",subtitleField:"status",columns:[{name:"order_id",label:"ID",type:"string",visible:true,editable:false,required:false},{name:"customer_id",label:"Customer",type:"relation",relation:"customers",visible:true,editable:true,required:true},{name:"order_date",label:"Order Date",type:"date",visible:true,editable:true,required:true},{name:"total_amount",label:"Total Amount",type:"number",visible:true,editable:true,required:true},{name:"created_at",label:"Created At",type:"date",visible:true,editable:false,required:false},{name:"updated_at",label:"Updated At",type:"date",visible:true,editable:false,required:false}],relations:[{table:"order_items",foreignKey:"order_id"}]},order_items:{primaryKey:"order_item_id",titleField:"id",subtitleField:"quantity",columns:[{name:"order_item_id",label:"ID",type:"string",visible:true,editable:false,required:false},{name:"order_id",label:"Order",type:"relation",relation:"orders",visible:true,editable:true,required:true},{name:"product_id",label:"Product",type:"relation",relation:"products",visible:true,editable:true,required:true},{name:"quantity",label:"Quantity",type:"number",visible:true,editable:true,required:true},{name:"unit_price",label:"Unit Price",type:"number",visible:true,editable:true,required:true},{name:"created_at",label:"Created At",type:"date",visible:true,editable:false,required:false},{name:"updated_at",label:"Updated At",type:"date",visible:true,editable:false,required:false}],relations:[]}};if(t[e]){this._tableMetadataCache[e]=t[e];if(this._entityCacheManager){const i=`metadata_${e}`;this._entityCacheManager.setEntityCache(i,t[e])}return t[e]}const i={primaryKey:"id",titleField:"name",subtitleField:"description",columns:[{name:"id",label:"ID",type:"string",visible:true,editable:false,required:false},{name:"name",label:"Name",type:"string",visible:true,editable:true,required:true},{name:"description",label:"Description",type:"text",visible:true,editable:true,required:false},{name:"created_at",label:"Created At",type:"date",visible:true,editable:false,required:false},{name:"updated_at",label:"Updated At",type:"date",visible:true,editable:false,required:false}],relations:[]};this._tableMetadataCache[e]=i;if(this._entityCacheManager){const t=`metadata_${e}`;this._entityCacheManager.setEntityCache(t,i)}return i},propagateModels:function(e){if(!e)return;const t=e.getView();if(!t)return;const i=this.getModel("device");if(i&&!t.getModel("device")){t.setModel(i,"device")}const a=this.getModel("appView");if(a&&!t.getModel("appView")){t.setModel(a,"appView")}const r=this.getModel("tables");if(r&&!t.getModel("tables")){t.setModel(r,"tables")}},createContent:function(){const t=e.prototype.createContent.apply(this,arguments);const i=sap.ui.view;const a=this;sap.ui.view=function(){const e=i.apply(this,arguments);const t=e.getController();if(t){a.propagateModels(t)}return e};return t},_initAppControllers:function(){const e=this.getRootControl();if(!e)return;const t=e.getController();if(!t)return;if(typeof t._initializeNavigationList==="function"){setTimeout(function(){t._initializeNavigationList()},500)}}})});
//# sourceMappingURL=Component.js.map