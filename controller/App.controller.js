sap.ui.define(["com/supabase/easyui5/controller/BaseController","sap/ui/model/json/JSONModel","sap/m/MessageBox","sap/m/Dialog","sap/m/Button","sap/m/Text","sap/m/List","sap/m/StandardListItem","sap/m/ResponsivePopover"],function(t,e,o,i,n,s,a,l,r){"use strict";return t.extend("com.supabase.easyui5.controller.App",{onInit:function(){console.log("🔍 APP DEBUG: App controller initializing");try{if(this.getView()&&this.getOwnerComponent()&&this.getOwnerComponent().getContentDensityClass){this.getView().addStyleClass(this.getOwnerComponent().getContentDensityClass())}const t=this.getRouter();if(t&&typeof this._onRouteMatched==="function"){t.attachRouteMatched(this._onRouteMatched,this)}const e=new sap.ui.model.json.JSONModel({navExpanded:true});this.setModel(e,"appView");if(this.getOwnerComponent()){this.getOwnerComponent().setModel(e,"appView")}this._initResponsiveBehavior();this._waitForTablesModel()}catch(t){console.error("🔍 APP DEBUG: Error in App controller init:",t)}},_waitForTablesModel:function(){console.log("🔍 APP DEBUG: Waiting for tables model...");const t=this.getOwnerComponent().getModel("tables");if(!t){console.log("🔍 APP DEBUG: Tables model not yet available, waiting...");setTimeout(this._waitForTablesModel.bind(this),500);return}const e=t.getProperty("/tables");if(!e||e.length===0){console.log("🔍 APP DEBUG: Tables data not yet available, waiting...");setTimeout(this._waitForTablesModel.bind(this),500);return}console.log("🔍 APP DEBUG: Tables model available, initializing navigation list");this._initializeNavigationList()},_onRouteMatched:function(t){const e=t.getParameter("name");const o=t.getParameter("arguments");console.log("App controller - Route matched:",e,o);const i=this.byId("app");if(i&&!sap.ui.Device.system.phone){if(e!=="home"&&!i.isMasterShown()){i.showMaster()}}},_adjustSplitAppMode:function(t,e){try{const o=e.getProperty("/system/phone");const i=e.getProperty("/system/tablet");const n=this.getModel("appView");console.log("Adjusting SplitApp mode. Phone:",o,"Tablet:",i);if(o){t.setMode("PopoverMode");t.hideMaster();if(n){n.setProperty("/navExpanded",false)}const e=this.byId("collapseNavButton");if(e){e.setIcon("sap-icon://menu2");e.setTooltip("Show Navigation")}}else if(i){t.setMode("ShowHideMode");if(window.innerHeight>window.innerWidth){t.hideMaster();if(n){n.setProperty("/navExpanded",false)}const e=this.byId("collapseNavButton");if(e){e.setIcon("sap-icon://menu2");e.setTooltip("Show Navigation")}}}else{t.setMode("ShowHideMode");t.showMaster();if(n){n.setProperty("/navExpanded",true)}const e=this.byId("collapseNavButton");if(e){e.setIcon("sap-icon://navigation-left-arrow");e.setTooltip("Hide Navigation")}}}catch(t){console.error("Error adjusting SplitApp mode:",t)}},onCollapseNav:function(){try{const t=this.byId("app");if(!t){console.error("SplitApp control not found!");return}const e=this.getModel("appView");const o=e.getProperty("/navExpanded");const i=this.byId("collapseNavButton");console.log("Toggle nav button pressed. Current state:",o?"expanded":"collapsed");if(o){t.hideMaster();if(i){i.setIcon("sap-icon://navigation-right-arrow");i.setTooltip("Show Navigation")}e.setProperty("/navExpanded",false)}else{t.showMaster();if(i){i.setIcon("sap-icon://navigation-left-arrow");i.setTooltip("Hide Navigation")}e.setProperty("/navExpanded",true)}}catch(t){console.error("Error in menu toggle:",t)}},onAfterMasterOpen:function(){const t=this.getModel("appView");if(t){t.setProperty("/navExpanded",true)}const e=this.byId("collapseNavButton");if(e){e.setIcon("sap-icon://navigation-left-arrow");e.setTooltip("Hide Navigation")}console.log("Master panel opened")},onAfterMasterClose:function(){const t=this.getModel("appView");if(t){t.setProperty("/navExpanded",false)}const e=this.byId("collapseNavButton");if(e){e.setIcon("sap-icon://navigation-right-arrow");e.setTooltip("Show Navigation")}console.log("Master panel closed")},onNavHome:function(){this.getRouter().navTo("home")},onNavToEntityList:function(t){const e=t.getSource();console.log("🔍 MENU DEBUG: Menu item pressed:",e);let o=null;if(e.data){o=e.data("tableId");console.log("🔍 MENU DEBUG: Table ID from data() API:",o)}if(!o&&e.getCustomData){const t=e.getCustomData();console.log("🔍 MENU DEBUG: Custom data entries:",t.length);if(t&&t.length>0){for(let e=0;e<t.length;e++){if(t[e].getKey()==="tableId"){o=t[e].getValue();console.log("🔍 MENU DEBUG: Table ID from custom data:",o);break}}}}if(o){console.log("🔍 MENU DEBUG: Navigating to entity list for:",o);this.getRouter().navTo("entityList",{table:o})}else{console.error("🔍 MENU DEBUG: No table ID found for navigation!")}},onNavListItemSelect:function(t){const e=t.getParameter("listItem");if(e.getId()===this.byId("homeItem").getId()){this.onNavHome();return}const o=e.data("tableId");if(o){this.getRouter().navTo("entityList",{table:o})}},onShowAbout:function(){if(!this._oAboutDialog){this._oAboutDialog=new i({title:"About Supabase Management",contentWidth:"26rem",content:[new s({text:"This application provides a user-friendly interface for managing your Supabase data. It's built with OpenUI5 and supports full CRUD operations on your tables."}).addStyleClass("sapUiSmallMargin")],beginButton:new n({text:"Close",press:function(){this._oAboutDialog.close()}.bind(this)})});this.getView().addDependent(this._oAboutDialog)}this._oAboutDialog.open()},onShowSettings:function(){if(!this._oSettingsDialog){this._oSettingsDialog=new i({title:"Settings",contentWidth:"20rem",content:new a({items:[new l({title:"Theme: Horizon",type:"Active",press:function(){sap.ui.getCore().applyTheme("sap_horizon");this._oSettingsDialog.close()}.bind(this)}),new l({title:"Theme: Horizon Dark",type:"Active",press:function(){sap.ui.getCore().applyTheme("sap_horizon_dark");this._oSettingsDialog.close()}.bind(this)}),new l({title:"Theme: Horizon High Contrast Black",type:"Active",press:function(){sap.ui.getCore().applyTheme("sap_horizon_hcb");this._oSettingsDialog.close()}.bind(this)}),new l({title:"Theme: Horizon High Contrast White",type:"Active",press:function(){sap.ui.getCore().applyTheme("sap_horizon_hcw");this._oSettingsDialog.close()}.bind(this)})]}),beginButton:new n({text:"Close",press:function(){this._oSettingsDialog.close()}.bind(this)})});this.getView().addDependent(this._oSettingsDialog)}this._oSettingsDialog.open()},_initResponsiveBehavior:function(){try{const t=this.byId("app");if(!t){console.error("SplitApp control not found in view!");return}let e=this.getModel("device");if(!e){e=this.getOwnerComponent().getModel("device");if(!e){console.warn("Device model not found, creating a new one");e=new sap.ui.model.json.JSONModel(sap.ui.Device);this.getOwnerComponent().setModel(e,"device");this.setModel(e,"device")}}this._adjustSplitAppMode(t,e);const o=function(){this._adjustSplitAppMode(t,e)}.bind(this);sap.ui.Device.resize.attachHandler(o);this._fnResponsiveHandler=o}catch(t){console.error("Error initializing responsive behavior:",t)}},_initializeNavigationList:function(){console.log("🔍 MENU DEBUG: Starting navigation list initialization");try{const t=this.getOwnerComponent().getModel("tables");if(!t){console.error("🔍 MENU DEBUG: Tables model not available!");setTimeout(this._initializeNavigationList.bind(this),1e3);return}const e=t.getProperty("/tables");console.log("🔍 MENU DEBUG: Tables from model:",e);if(!e||e.length===0){console.error("🔍 MENU DEBUG: No tables found in model");setTimeout(this._initializeNavigationList.bind(this),1e3);return}const o=this.byId("navigationList");console.log("🔍 MENU DEBUG: Navigation list control:",o);if(!o){console.error("🔍 MENU DEBUG: Navigation list control not found!");return}const i=this.byId("homeItem");console.log("🔍 MENU DEBUG: Home item:",i);console.log("🔍 MENU DEBUG: Clearing existing items");o.removeAllItems();if(i){console.log("🔍 MENU DEBUG: Re-adding existing home item");o.addItem(i)}else{console.log("🔍 MENU DEBUG: Creating new home item");const t=new sap.m.StandardListItem({id:this.createId("homeItem"),title:"Home",icon:"sap-icon://home",type:"Navigation"});t.attachPress(this.onNavHome,this);o.addItem(t)}console.log("🔍 MENU DEBUG: Adding table items, count:",e.length);e.forEach((t,e)=>{console.log(`🔍 MENU DEBUG: Adding item ${e+1}:`,t.id,t.title);const i=new sap.m.StandardListItem({id:this.createId("navItem_"+t.id),title:t.title,icon:t.icon||"sap-icon://table-view",type:"Navigation"});i.addCustomData(new sap.ui.core.CustomData({key:"tableId",value:t.id,writeToDom:true}));i.attachPress(this.onNavToEntityList,this);o.addItem(i);console.log(`🔍 MENU DEBUG: Added item for ${t.title}`)});console.log("🔍 MENU DEBUG: Navigation list initialization complete!");o.invalidate()}catch(t){console.error("🔍 MENU DEBUG: Error in initialization:",t)}}})});
//# sourceMappingURL=App.controller.js.map