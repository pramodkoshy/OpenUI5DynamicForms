sap.ui.define(["com/supabase/easyui5/controller/BaseController","sap/ui/model/json/JSONModel","sap/m/Column","sap/m/Text","sap/m/Label","com/supabase/easyui5/control/FormDialog"],function(t,e,o,i,s,n){"use strict";return t.extend("com.supabase.easyui5.controller.EnhancedEntityList",{onInit:function(){const t=new e({tableName:"",tableId:"",items:[],busy:false});this.setModel(t,"viewModel");this.getRouter().getRoute("entityList").attachPatternMatched(this._onRouteMatched,this)},_onRouteMatched:function(t){const e=t.getParameter("arguments").table;console.log("EntityList route matched with table:",e);const o=this.getModel("viewModel");o.setProperty("/tableId",e);const i=e.charAt(0).toUpperCase()+e.slice(1).replace(/_/g," ");o.setProperty("/tableName",i);this.getView().byId("entityListPage").setTitle(i+" List");this.getTableMetadata(e).then(t=>{this._oTableMetadata=t;this._configureTable(t);this._loadData(e,t)}).catch(t=>{console.error("Error loading metadata:",t)})},_configureTable:function(t){},_loadData:function(t,e){},onItemPress:function(t){},onCreatePress:function(){const t=this.getModel("viewModel").getProperty("/tableId");const e=this.getModel("viewModel").getProperty("/tableName");this._oCreateDialog=new n(this,{title:"Create New "+e,mode:"create",tableId:t,successCallback:function(o){this.showSuccessMessage(e+" created successfully");this._loadData(t,this._oTableMetadata)}.bind(this),cancelCallback:function(){console.log("Create operation cancelled")}}).open()},onItemContextMenu:function(t){const e=t.getSource();const o=e.getBindingContext("viewModel");if(!o){return}const i=o.getObject();const s=this.getModel("viewModel").getProperty("/tableId");const n=this.getModel("viewModel").getProperty("/tableName");const a=this._oTableMetadata.primaryKey;const l=i[a];if(!this._oContextMenu){this._oContextMenu=new sap.m.Menu({items:[new sap.m.MenuItem({text:"Edit",icon:"sap-icon://edit",press:function(){this._openEditDialog(s,l,i,n)}.bind(this)}),new sap.m.MenuItem({text:"Delete",icon:"sap-icon://delete",press:function(){this._confirmAndDeleteEntity(s,l,n)}.bind(this)})]});this.getView().addDependent(this._oContextMenu)}this._oContextMenu.openBy(e)},onEditButtonPress:function(t){const e=t.getSource();const o=e.getParent().getParent();const i=o.getBindingContext("viewModel");if(!i){return}const s=i.getObject();const n=this.getModel("viewModel").getProperty("/tableId");const a=this.getModel("viewModel").getProperty("/tableName");const l=this._oTableMetadata.primaryKey;const c=s[l];this._openEditDialog(n,c,s,a)},_openEditDialog:function(t,e,o,i){this._oEditDialog=new n(this,{title:"Edit "+i,mode:"edit",tableId:t,entityId:e,entity:o,metadata:this._oTableMetadata,successCallback:function(e){this.showSuccessMessage(i+" updated successfully");this._loadData(t,this._oTableMetadata)}.bind(this),cancelCallback:function(){console.log("Edit operation cancelled")}}).open()},_confirmAndDeleteEntity:function(t,e,o){this.showConfirmationDialog("Are you sure you want to delete this "+o+"?",function(){this.getSupabaseClient().from(t).delete().eq(this._oTableMetadata.primaryKey,e).then(({error:e})=>{if(e){this.showErrorMessage("Error deleting "+o,e);return}this.showSuccessMessage(o+" deleted successfully");this._loadData(t,this._oTableMetadata)}).catch(t=>{this.showErrorMessage("Error deleting "+o,t)})}.bind(this),"Delete Confirmation")},onDeleteSelectedPress:function(){},onRefreshPress:function(){const t=this.getModel("viewModel").getProperty("/tableId");this._loadData(t,this._oTableMetadata)},onSearch:function(t){},onExit:function(){if(this._oCreateDialog){this._oCreateDialog.destroy();this._oCreateDialog=null}if(this._oEditDialog){this._oEditDialog.destroy();this._oEditDialog=null}if(this._oContextMenu){this._oContextMenu.destroy();this._oContextMenu=null}}})});
//# sourceMappingURL=EnhancedEntityList.controller.js.map